---
title: "Association of two variables"
output: html_notebook
---

Creating a dummie dataset
```{r}
X = sample(x=20:35, size=100, replace=TRUE)
Y = sample(x=30:40, size=100, replace=TRUE)
```


Contingency table
```{r}
addmargins(table(X, Y))
```


Contingency table (relative frequencies)
```{r}
addmargins(prop.table(table(X,Y)))
```


# Bar charts
```{r}
air_class <- c(rep('1: Economy', 62), rep('2: Business', 25), rep('3: First', 13))
air_rating <- c(rep('1=poor', 10), rep('2=fair', 36), rep('3=Good', 40), rep('4=Very good', 14))

library(lattice)
barchart(table(air_class, air_rating), horizontal=FALSE, stack=FALSE)
barchart(table(air_class, air_rating), horizontal=FALSE, stack=FALSE)
```


To calculate the expected absolute frequencies in R, we can access the
"expected" object returned from a $\chi^2$-test applied to the respective contingency
table as follows:
```{r}
air_chisq <- chisq.test(table(air_class, air_rating))
air_chisq
```

```{r}
air_chisq$expected
```


Value of $\chi^2$ is between $0 \leq \chi^2 \leq n(\min(k, l) - 1)$
```{r}
air_chisq$statistic
```


Computing the Cramer's $V$ Statistic (Normalized $\chi^2$)
```{r}
library(vcd)
assocstats(xtabs(~ air_class + air_rating))
```

Computing the the (corrected version) Contingency Coefficient $C$
```{r}
library(vcd)
C_max = sqrt(
    (min(c(3, 4)) - 1) / min(c(3, 4))
)
assocstats(xtabs(~ air_class + air_rating))$cont / C_max
```

